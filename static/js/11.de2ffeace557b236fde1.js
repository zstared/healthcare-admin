webpackJsonp([11],{Ci38:function(e,t){},JISC:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("mtWM"),o=i.n(n),a=(i("mFIW"),i("2uFj")),l=i("0xDb"),s=i("gyMJ"),c={data:function(){return{test:"",selectClass:"el-icon-arrow-down",first_search:!0,content_show:!1,formSearch:{type_code:"",key_word:""},dialogVisible:!1,select_method:"",second_select_list:[],page_select_size:10,currentSelectPage:1,select_total:15,dataSource:[],currentPage:1,page_size:15,total:0,columns:[{text:"组件类型",value:"type_code",width:200},{text:"标题",value:"title"},{text:"副标题",value:"subtitle"},{text:"图片",value:"icon_info",width:110,type:"img"},{text:"状态",value:"status",width:100}],formLabelAlign:{type_code:"",type_id:0,parent_id:0,title:"",code:"",subtitle:"",content:"",icon:"",icon_name:"",status:0,link:"",sort_no:0,news_ids:[]},rules:{type_code:[{required:!0,message:"请选择组件类型",trigger:"blur"}],type_id:[{required:!0,message:"请选择关联ID",trigger:"blur"}],title:[{required:!0,message:"请输入标题",trigger:"blur"}],parent_id:[{required:!0,message:"请输入根据点ID"}]},config:{initialFrameWidth:null,initialFrameHeight:350,serverUrl:s.b+"core/file/upload?token="+l.e.getItem(a.authToken,"healthcare"),imageActionName:s.b+"core/file/upload",zIndex:1e4},component_type_list:[],dialog_type:0,loading:null}},mounted:function(){this.getdDictionaryInfo()},methods:{moreSelect:function(){"el-icon-arrow-down"==this.selectClass?(this.selectClass="el-icon-arrow-up",this.content_show=!0):(this.selectClass="el-icon-arrow-down",this.content_show=!1)},onSubmit:function(){this.getInfoList("1","15")},openAddDialog:function(){this.dialog_type=0,this.formLabelAlign={type_code:this.formLabelAlign.type_code,type_id:this.formLabelAlign.type_id,parent_id:0,title:"",code:"",subtitle:"",content:"",icon:"",icon_name:"",status:0,link:"",sort_no:0,news_ids:[]},this.dialogVisible=!0},handleClose:function(){var e=this,t=this;this.$confirm("是否保存？",{showClose:!1}).then(function(){t.addInfo("formLabelAlign")}).catch(function(){e.dialogVisible=!1})},handleChange:function(e){this.select_method=e,this.currentSelectPage=1,this.getSecondSelectList()},handleSelectCurrentChange:function(e){this.currentSelectPage=e,this.getSecondSelectList()},handleDelete:function(e,t){var i=this;this.$confirm("是否确认删除该条信息?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={id:t.id};i.submitInfo("content/component/delete",e,"删除成功!")}).catch(function(){})},handleEdit:function(e,t){this.dialog_type=2,this.showLoading(),this.getDetail(t.id)},getDetail:function(e){var t=this;o.a.get("content/component/details/"+e,{params:{}}).then(function(e){if(0==e.code){var i=e.data,n="",o="";null!=i.icon_info&&(n=i.icon_info.src,o=i.icon_info.name),i.icon_src=n,i.icon_name=o,t.formLabelAlign=i,t.loading&&t.closeLoading(),t.dialogVisible=!0}},function(e){})},showLoading:function(){this.loading=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"})},closeLoading:function(){this.loading&&this.loading.close()},handleAdd:function(e,t){this.dialog_type=1,console.log(t),this.formLabelAlign={type_code:t.type_code,type_id:t.type_id,parent_id:t.id,title:"",code:"",subtitle:"",content:"",icon:"",icon_name:"",status:0,link:"",sort_no:0,news_ids:[]},this.dialogVisible=!0},beforeUpload:function(e){var t=this,i=new window.FormData;return i.append("file",e),o.a.post("core/file/upload",i,{headers:{"Content-Type":"multipart/form-data",token:l.e.getItem(a.authToken,"healthcare")}}).then(function(i){if(0==i.code){i.data.url;t.formLabelAlign.icon_name=e.name,t.formLabelAlign.icon=i.data.code,t.$message({type:"success",message:"上传成功！"})}}),!1},getEditorContent:function(e){this.formLabelAlign.content=e},getSecondSelectList:function(){var e={page_index:this.currentSelectPage,page_size:this.page_select_size},t=this,i="content/"+this.select_method+"/pageList";o.a.get(i,{params:e}).then(function(e){if(0==e.code){var i=[],n=e.data;t.page_select_size=n.page_size,t.currentSelectPage=n.page_index,t.select_total=n.count;for(var o=n.rows,a=t.select_method+"_id",l=0;l<o.length;l++){var s={title:o[l].title,type_id:o[l][a]};i.push(s)}i&&(t.formSearch.type_id=i[0].type_id,t.formLabelAlign.type_id=i[0].type_id,t.formLabelAlign.parent_id=i[0].type_id,t.formLabelAlign.title=i[0].title),t.second_select_list=i,t.first_search&&(t.first_search=!1,t.getInfoList("1","15"))}},function(e){})},addInfo:function(e){var t=this;this.showLoading(),this.$refs[e].validate(function(e){if(!e)return t.closeLoading(),!1;var i="",n="";2==t.dialog_type?(i="content/component/update",n="修改成功!"):(i="content/component/create",n="添加成功!"),t.submitInfo(i,t.formLabelAlign,n)})},submitInfo:function(e,t,i){var n=this;o.a.post(e,t).then(function(e){n.closeLoading(),0==e.code?(n.$message({type:"success",message:i}),n.dialogVisible=!1,n.getInfoList(n.currentPage,n.page_size)):n.$message({type:"success",message:"操作失败:"+e.message})},function(e){n.closeLoading()})},getInfoList:function(e,t){var i={type_code:this.formSearch.type_code,type_id:this.formSearch.type_id,page_index:e,page_size:t},n=this;o.a.get("content/component/rootList",{params:i}).then(function(i){var o=i.code;if(console.log(i),0==o){for(var a=[],l=i.data,s=(e-1)*t,c=l,r=0;r<c.length;r++){var d="未发布";1==c[r].status&&(d="已发布"),c[r].index=s+r+1,c[r].status_name=d,a.push(c[r])}n.dataSource=a}},function(e){})},getdDictionaryInfo:function(){var e=this;o.a.get("core/dictionary/list",{params:{code:"component_type"}}).then(function(t){0==t.code&&(e.component_type_list=t.data,e.component_type_list&&(e.formSearch.type_code=e.component_type_list[0].value,e.select_method=e.formSearch.type_code,e.currentSelectPage=1,e.formLabelAlign.type_code=e.component_type_list[0].value,e.getSecondSelectList()))},function(e){})}}},r={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-row",{staticStyle:{"margin-bottom":"20px"}},[i("el-card",{attrs:{shadow:"always"}},[i("span",{staticClass:"content-title"},[e._v("组件管理")]),e._v(" "),i("el-button",{attrs:{type:"success"},on:{click:function(t){return e.openAddDialog()}}},[e._v("新增")]),e._v(" "),i("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.moreSelect}},[i("i",{class:e.selectClass}),e._v("更多选项")]),e._v(" "),e.content_show?i("div",{staticClass:"advanced-box"},[i("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formSearch}},[i("el-form-item",{attrs:{label:"组件类型"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},on:{change:e.handleChange},model:{value:e.formSearch.type_code,callback:function(t){e.$set(e.formSearch,"type_code",t)},expression:"formSearch.type_code"}},e._l(e.component_type_list,function(e){return i("el-option",{key:e.code,attrs:{label:e.name,value:e.value}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"关联ID",prop:"type_id"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.formSearch.type_id,callback:function(t){e.$set(e.formSearch,"type_id",t)},expression:"formSearch.type_id"}},[e._l(e.second_select_list,function(e){return i("el-option",{key:e.type_id,attrs:{label:e.title,value:e.type_id}})}),e._v(" "),i("div",{staticClass:"text-center",staticStyle:{position:"sticky",background:"#fff",height:"30px",top:"0","z-index":"1"}},[i("a",{staticClass:"text-normal"},[i("el-pagination",{staticClass:"pagination",attrs:{"page-sizes":[10],"page-size":e.page_select_size,"current-page":e.currentSelectPage,total:e.select_total,layout:"prev,pager, next"},on:{"current-change":e.handleSelectCurrentChange,"update:currentPage":function(t){e.currentSelectPage=t},"update:current-page":function(t){e.currentSelectPage=t}}})],1)])],2)],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("查询")])],1)],1)],1):e._e()],1)],1),e._v(" "),i("div",{staticStyle:{width:"50px",height:"50px"}},[i("img",{staticStyle:{width:"50px",height:"50px"},attrs:{src:e.test,alt:""}})]),e._v(" "),i("treeTable",{attrs:{columns:e.columns,"tree-structure":!0,data:e.dataSource},on:{"on-delete":e.handleDelete,"on-edit":e.handleEdit,"on-add":e.handleAdd}}),e._v(" "),i("el-dialog",{attrs:{title:"新增",visible:e.dialogVisible,width:"60%",top:"5vh","append-to-body":!0,"before-close":e.handleClose,closeOnClickModal:!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("div",{staticClass:"el-dialog-news"},[i("el-form",{ref:"formLabelAlign",attrs:{"label-position":"top",rules:e.rules,"label-width":"80px",model:e.formLabelAlign}},[i("el-form-item",{attrs:{label:"组件类型",prop:"type_code"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{disabled:0!=e.dialog_type,placeholder:"请选择"},on:{change:e.handleChange},model:{value:e.formLabelAlign.type_code,callback:function(t){e.$set(e.formLabelAlign,"type_code",t)},expression:"formLabelAlign.type_code"}},e._l(e.component_type_list,function(e){return i("el-option",{key:e.code,attrs:{label:e.name,value:e.value}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"关联ID",prop:"type_id"}},[i("el-select",{staticStyle:{width:"100%"},attrs:{disabled:2==e.dialog_type,placeholder:"请选择"},model:{value:e.formLabelAlign.type_id,callback:function(t){e.$set(e.formLabelAlign,"type_id",t)},expression:"formLabelAlign.type_id"}},[e._l(e.second_select_list,function(e){return i("el-option",{key:e.type_id,attrs:{label:e.title,value:e.type_id}})}),e._v(" "),i("div",{staticClass:"text-center",staticStyle:{position:"sticky",background:"#fff",height:"30px",top:"0","z-index":"1"}},[i("a",{staticClass:"text-normal"},[i("el-pagination",{staticClass:"pagination",attrs:{"page-sizes":[10],"page-size":e.page_select_size,"current-page":e.currentSelectPage,total:e.select_total,layout:"prev,pager, next"},on:{"current-change":e.handleSelectCurrentChange,"update:currentPage":function(t){e.currentSelectPage=t},"update:current-page":function(t){e.currentSelectPage=t}}})],1)])],2)],1),e._v(" "),i("el-form-item",{attrs:{label:"标题",prop:"title"}},[i("el-input",{model:{value:e.formLabelAlign.title,callback:function(t){e.$set(e.formLabelAlign,"title",t)},expression:"formLabelAlign.title"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"副标题"}},[i("el-input",{model:{value:e.formLabelAlign.subtitle,callback:function(t){e.$set(e.formLabelAlign,"subtitle",t)},expression:"formLabelAlign.subtitle"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"编码"}},[i("el-input",{model:{value:e.formLabelAlign.code,callback:function(t){e.$set(e.formLabelAlign,"code",t)},expression:"formLabelAlign.code"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"图片",prop:"icon_name"}},[i("el-col",{attrs:{span:20}},[i("el-input",{attrs:{disabled:!0},model:{value:e.formLabelAlign.icon_name,callback:function(t){e.$set(e.formLabelAlign,"icon_name",t)},expression:"formLabelAlign.icon_name"}})],1),e._v(" "),i("el-upload",{staticClass:"upload-demo",attrs:{action:"core/file/upload",multiple:"",limit:1,"before-upload":e.beforeUpload,"show-file-list":!1}},[i("el-button",{attrs:{size:"medium",type:"primary"}},[e._v("点击上传")])],1)],1),e._v(" "),i("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"content"}}),e._v(" "),i("div",{staticClass:"editor-container"},[i("ueditor",{ref:"ueditor",attrs:{defaultMsg:e.formLabelAlign.content,config:e.config},on:{postEditorToParent:e.getEditorContent}})],1),e._v(" "),i("el-form-item",{attrs:{label:"摘要"}},[i("el-input",{model:{value:e.formLabelAlign.summary,callback:function(t){e.$set(e.formLabelAlign,"summary",t)},expression:"formLabelAlign.summary"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"发布状态"}},[i("el-radio-group",{model:{value:e.formLabelAlign.status,callback:function(t){e.$set(e.formLabelAlign,"status",t)},expression:"formLabelAlign.status"}},[i("el-radio",{attrs:{label:0}},[e._v("未发布")]),e._v(" "),i("el-radio",{attrs:{label:1}},[e._v("已发布")])],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"链接"}},[i("el-input",{model:{value:e.formLabelAlign.link,callback:function(t){e.$set(e.formLabelAlign,"link",t)},expression:"formLabelAlign.link"}})],1)],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addInfo("formLabelAlign")}}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var d=i("VU/8")(c,r,!1,function(e){i("Ci38")},"data-v-1daa0912",null).exports;t.default=d}});
//# sourceMappingURL=11.de2ffeace557b236fde1.js.map